{% extends "app/base.html" %}
{% block title %}PRD-Pdf file{% endblock %}
{% block content %}

<div class="container">
    <div class="row">
      <div class="col-9">
            <embed src="{{pdf_file_object.pdf_file.url}}" type="application/pdf" width="100%" height="600px">
      </div>
      <div class="col-3">
        <h4>Comments:</h4>
        <ul class="list-group list-group-flush">
            {% for comment in comments %}
                <li class="list-group-item">{{ comment.comment }}</li>
            {% endfor %}
          </ul>
      </div>

    </div>
    <div class="row">
      <button onclick="toggleForm()">Invite others for discussion</button>
    </div>


    <div class="row mx-auto">
      <div id="email-form-01" style="display: none;">
        <form id="email-form" method="post">
          {% csrf_token %}

            <div class="row">
                        <div class="col-5">
                          <input type="email" class="form-control" name="email" id="email-input" placeholder="Enter their Email to send invite link for this document">
                        </div>
                        <div class="col-1"></div> 
                  <div class="col-5">
                        <button type="submit" class="btn btn-primary">invite</button>
                  </div>
            </div>   
        </form>
        
      </div>
    </div>


    </div>
  </div>


{% endblock content %}


{% block javascript %}

  <script>
    console.log("entered login");
    var id={{pdf_file_object.id}}
    console.log(id);

    function toggleForm() {
      var x = document.getElementById("email-form-01");
      if (x.style.display === "none") {
        x.style.display = "block";
      } else {
        x.style.display = "none";
      }
    }

    $(document).ready(function() {
      // Handle form submission using AJAX
      $('#email-form').on('submit', function(event) {
          event.preventDefault();
          var email = $('#email-input').val();
          var id= {{pdf_file_object.id}}
 // Get the CSRF token from a form input field
          $.ajax({
              url: '{% url 'invite_form' %}',  // Replace with the actual server URL
              type: 'POST',
              data: {  email: email , id:id, csrfmiddlewaretoken: '{{ csrf_token }}'}, // Include the CSRF token in the form data
              success: function(response) {
                  console.log('Email sent successfully!');
                  $('#email-input').val('');
              },
              error: function(xhr, status, error) {
                  console.error('Error:', error);
              },

          });
      });
  });











</script>
{% endblock javascript %}